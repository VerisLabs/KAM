<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>kToken - KAM Contracts Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../book.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">KAM Contracts Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/VerisLabs/KAM" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ktoken"><a class="header" href="#ktoken">kToken</a></h1>
<<<<<<< HEAD
<p><a href="https://github.com/VerisLabs/KAM/blob/39577197165fca22f4727dda301114283fca8759/src/kToken.sol">Git Source</a></p>
=======
<p><a href="https://github.com/VerisLabs/KAM/blob/e655bf086c79b14fd5ccde0a4ddfa1609e381102/src/kToken.sol">Git Source</a></p>
>>>>>>> main
<p><strong>Inherits:</strong>
<a href="/src/vendor/ERC20.sol/abstract.ERC20.html">ERC20</a>, <a href="/src/libraries/OptimizedOwnableRoles.sol/abstract.OptimizedOwnableRoles.html">OptimizedOwnableRoles</a>, <a href="/src/abstracts/OptimizedReentrancyGuardTransient.sol/abstract.OptimizedReentrancyGuardTransient.html">OptimizedReentrancyGuardTransient</a>, <a href="/src/vendor/Multicallable.sol/abstract.Multicallable.html">Multicallable</a></p>
<p>ERC20 representation of underlying assets with guaranteed 1:1 backing in the KAM protocol</p>
<p><em>This contract serves as the tokenized wrapper for protocol-supported underlying assets (USDC, WBTC, etc.).
Each kToken maintains a strict 1:1 relationship with its underlying asset through controlled minting and burning.
Key characteristics: (1) Authorized minters (kMinter for institutional deposits, kAssetRouter for yield
distribution)
can create/destroy tokens, (2) kMinter mints tokens 1:1 when assets are deposited and burns during redemptions,
(3) kAssetRouter mints tokens to distribute positive yield to vaults and burns tokens for negative yield/losses,
(4) Implements three-tier role system: ADMIN_ROLE for management, EMERGENCY_ADMIN_ROLE for emergency operations,
MINTER_ROLE for token creation/destruction, (5) Features emergency pause mechanism to halt all transfers during
protocol emergencies, (6) Supports emergency asset recovery for accidentally sent tokens. The contract ensures
protocol integrity by maintaining that kToken supply accurately reflects the underlying asset backing plus any
distributed yield, while enabling efficient yield distribution without physical asset transfers.</em></p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="admin_role"><a class="header" href="#admin_role">ADMIN_ROLE</a></h3>
<p>Role constants</p>
<pre><code class="language-solidity">uint256 public constant ADMIN_ROLE = _ROLE_0;
</code></pre>
<h3 id="emergency_admin_role"><a class="header" href="#emergency_admin_role">EMERGENCY_ADMIN_ROLE</a></h3>
<pre><code class="language-solidity">uint256 public constant EMERGENCY_ADMIN_ROLE = _ROLE_1;
</code></pre>
<h3 id="minter_role"><a class="header" href="#minter_role">MINTER_ROLE</a></h3>
<pre><code class="language-solidity">uint256 public constant MINTER_ROLE = _ROLE_2;
</code></pre>
<h3 id="_ispaused"><a class="header" href="#_ispaused">_isPaused</a></h3>
<p>Emergency pause state flag for halting all token operations during crises</p>
<p><em>When true, prevents all transfers, minting, and burning through _beforeTokenTransfer hook</em></p>
<pre><code class="language-solidity">bool _isPaused;
</code></pre>
<h3 id="_name"><a class="header" href="#_name">_name</a></h3>
<<<<<<< HEAD
<p>Human-readable name of the kToken (e.g., "KAM USDC")</p>
<p><em>Stored privately to override ERC20 default implementation with custom naming</em></p>
<pre><code class="language-solidity">string private _name;
</code></pre>
<h3 id="_symbol"><a class="header" href="#_symbol">_symbol</a></h3>
<p>Trading symbol of the kToken (e.g., "kUSDC")</p>
<p><em>Stored privately to provide consistent protocol naming convention</em></p>
<pre><code class="language-solidity">string private _symbol;
</code></pre>
<h3 id="_decimals"><a class="header" href="#_decimals">_decimals</a></h3>
<p>Number of decimal places for the kToken, matching the underlying asset</p>
<p><em>Critical for maintaining 1:1 exchange rates with underlying assets</em></p>
=======
<pre><code class="language-solidity">string private _name;
</code></pre>
<h3 id="_symbol"><a class="header" href="#_symbol">_symbol</a></h3>
<pre><code class="language-solidity">string private _symbol;
</code></pre>
<h3 id="_decimals"><a class="header" href="#_decimals">_decimals</a></h3>
>>>>>>> main
<pre><code class="language-solidity">uint8 private _decimals;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<<<<<<< HEAD
<p>Deploys and initializes a new kToken with specified parameters and role assignments</p>
<p><em>This constructor is called by kRegistry during asset registration to create the kToken wrapper.
The process establishes: (1) ownership hierarchy with owner at the top, (2) role assignments for protocol
operations, (3) token metadata matching the underlying asset. The decimals parameter is particularly
important as it must match the underlying asset to maintain accurate 1:1 exchange rates.</em></p>
=======
<p>Disables initializers to prevent implementation contract from being initialized</p>
<p><em>Calls _disableInitializers from Solady's Initializable to lock implementation</em></p>
>>>>>>> main
<pre><code class="language-solidity">constructor(
    address owner_,
    address admin_,
    address emergencyAdmin_,
    address minter_,
    string memory name_,
    string memory symbol_,
    uint8 decimals_
);
</code></pre>
<<<<<<< HEAD
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>owner_</code></td><td><code>address</code></td><td>The contract owner (typically kRegistry or protocol governance)</td></tr>
<tr><td><code>admin_</code></td><td><code>address</code></td><td>Address to receive ADMIN_ROLE for managing minters and emergency admins</td></tr>
<tr><td><code>emergencyAdmin_</code></td><td><code>address</code></td><td>Address to receive EMERGENCY_ADMIN_ROLE for pause/emergency operations</td></tr>
<tr><td><code>minter_</code></td><td><code>address</code></td><td>Address to receive initial MINTER_ROLE (typically kMinter contract)</td></tr>
<tr><td><code>name_</code></td><td><code>string</code></td><td>Human-readable token name (e.g., "KAM USDC")</td></tr>
<tr><td><code>symbol_</code></td><td><code>string</code></td><td>Token symbol for trading (e.g., "kUSDC")</td></tr>
<tr><td><code>decimals_</code></td><td><code>uint8</code></td><td>Decimal places matching the underlying asset for accurate conversions</td></tr>
</tbody></table>
</div>
=======
>>>>>>> main
<h3 id="mint"><a class="header" href="#mint">mint</a></h3>
<p>Creates new kTokens and assigns them to the specified address</p>
<p><em>This function serves two critical purposes in the KAM protocol: (1) kMinter calls this when institutional
users deposit underlying assets, minting kTokens 1:1 to maintain backing ratio, (2) kAssetRouter calls this
to distribute positive yield to vaults, increasing the kToken supply to reflect earned returns. The function
is restricted to MINTER_ROLE holders (kMinter, kAssetRouter) and requires the contract to not be paused.
All minting operations emit a Minted event for transparency and tracking.</em></p>
<pre><code class="language-solidity">function mint(address _to, uint256 _amount) external onlyRoles(MINTER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_to</code></td><td><code>address</code></td><td>The address that will receive the newly minted kTokens</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The quantity of kTokens to create (matches asset amount for deposits, yield amount for distributions)</td></tr>
</tbody></table>
</div>
<h3 id="burn"><a class="header" href="#burn">burn</a></h3>
<p>Destroys kTokens from the specified address</p>
<p><em>This function handles token destruction for two main scenarios: (1) kMinter burns escrowed kTokens during
successful redemptions, reducing total supply to match the underlying assets being withdrawn, (2) kAssetRouter
burns kTokens from vaults when negative yield/losses occur, ensuring the kToken supply accurately reflects the
reduced underlying asset value. The burn operation is permanent and irreversible, requiring careful validation.
Only MINTER_ROLE holders can execute burns, and the contract must not be paused.</em></p>
<pre><code class="language-solidity">function burn(address _from, uint256 _amount) external onlyRoles(MINTER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_from</code></td><td><code>address</code></td><td>The address from which kTokens will be permanently destroyed</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The quantity of kTokens to burn (matches redeemed assets or loss amounts)</td></tr>
</tbody></table>
</div>
<h3 id="burnfrom"><a class="header" href="#burnfrom">burnFrom</a></h3>
<p>Destroys kTokens from a specified address using the ERC20 allowance mechanism</p>
<p><em>This function enables more complex burning scenarios where the token holder has pre-approved the burn
operation. The process involves: (1) checking and consuming the allowance between token owner and the minter,
(2) burning the specified amount from the owner's balance. This is useful for automated systems or contracts
that need to burn tokens on behalf of users, such as complex redemption flows or third-party integrations.
The allowance model provides additional security by requiring explicit approval before token destruction.</em></p>
<pre><code class="language-solidity">function burnFrom(address _from, uint256 _amount) external onlyRoles(MINTER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_from</code></td><td><code>address</code></td><td>The address from which kTokens will be burned (must have approved the burn amount)</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The quantity of kTokens to burn using the allowance mechanism</td></tr>
</tbody></table>
</div>
<h3 id="name"><a class="header" href="#name">name</a></h3>
<p>Retrieves the human-readable name of the token</p>
<p><em>Returns the name stored in contract storage during initialization</em></p>
<pre><code class="language-solidity">function name() public view virtual override returns (string memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>string</code></td><td>The token name as a string</td></tr>
</tbody></table>
</div>
<h3 id="symbol"><a class="header" href="#symbol">symbol</a></h3>
<p>Retrieves the abbreviated symbol of the token</p>
<p><em>Returns the symbol stored in contract storage during initialization</em></p>
<pre><code class="language-solidity">function symbol() public view virtual override returns (string memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>string</code></td><td>The token symbol as a string</td></tr>
</tbody></table>
</div>
<h3 id="decimals"><a class="header" href="#decimals">decimals</a></h3>
<p>Retrieves the number of decimal places for the token</p>
<p><em>Returns the decimals value stored in contract storage during initialization</em></p>
<pre><code class="language-solidity">function decimals() public view virtual override returns (uint8);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint8</code></td><td>The number of decimal places as uint8</td></tr>
</tbody></table>
</div>
<h3 id="ispaused"><a class="header" href="#ispaused">isPaused</a></h3>
<p>Checks whether the contract is currently in paused state</p>
<p><em>Reads the isPaused flag from contract storage</em></p>
<pre><code class="language-solidity">function isPaused() external view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Boolean indicating if contract operations are paused</td></tr>
</tbody></table>
</div>
<h3 id="grantadminrole"><a class="header" href="#grantadminrole">grantAdminRole</a></h3>
<p>Grants administrative privileges to a new address</p>
<p><em>Only the contract owner can grant admin roles, establishing the highest level of access control.
Admins can manage emergency admins and minter roles but cannot bypass owner-only functions.</em></p>
<pre><code class="language-solidity">function grantAdminRole(address admin) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>admin</code></td><td><code>address</code></td><td>The address to receive administrative privileges</td></tr>
</tbody></table>
</div>
<h3 id="revokeadminrole"><a class="header" href="#revokeadminrole">revokeAdminRole</a></h3>
<p>Removes administrative privileges from an address</p>
<p><em>Only the contract owner can revoke admin roles, maintaining strict access control hierarchy.
Revoking admin status prevents the address from managing emergency admins and minter roles.</em></p>
<pre><code class="language-solidity">function revokeAdminRole(address admin) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>admin</code></td><td><code>address</code></td><td>The address to lose administrative privileges</td></tr>
</tbody></table>
</div>
<h3 id="grantemergencyrole"><a class="header" href="#grantemergencyrole">grantEmergencyRole</a></h3>
<p>Grants emergency administrative privileges for protocol safety operations</p>
<p><em>Emergency admins can pause/unpause the contract and execute emergency withdrawals during crises.
This role is critical for protocol security and should only be granted to trusted addresses with
operational procedures in place. Only existing admins can grant emergency roles.</em></p>
<pre><code class="language-solidity">function grantEmergencyRole(address emergency) external onlyRoles(ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>emergency</code></td><td><code>address</code></td><td>The address to receive emergency administrative privileges</td></tr>
</tbody></table>
</div>
<h3 id="revokeemergencyrole"><a class="header" href="#revokeemergencyrole">revokeEmergencyRole</a></h3>
<p>Removes emergency administrative privileges from an address</p>
<p><em>Removes the ability to pause contracts and execute emergency operations. This should be done
carefully as it reduces the protocol's ability to respond to emergencies.</em></p>
<pre><code class="language-solidity">function revokeEmergencyRole(address emergency) external onlyRoles(ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>emergency</code></td><td><code>address</code></td><td>The address to lose emergency administrative privileges</td></tr>
</tbody></table>
</div>
<h3 id="grantminterrole"><a class="header" href="#grantminterrole">grantMinterRole</a></h3>
<p>Assigns minter role privileges to the specified address</p>
<p><em>Calls internal _grantRoles function to assign MINTER_ROLE</em></p>
<pre><code class="language-solidity">function grantMinterRole(address minter) external onlyRoles(ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>minter</code></td><td><code>address</code></td><td>The address that will receive minter role privileges</td></tr>
</tbody></table>
</div>
<h3 id="revokeminterrole"><a class="header" href="#revokeminterrole">revokeMinterRole</a></h3>
<p>Removes minter role privileges from the specified address</p>
<p><em>Calls internal _removeRoles function to remove MINTER_ROLE</em></p>
<pre><code class="language-solidity">function revokeMinterRole(address minter) external onlyRoles(ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>minter</code></td><td><code>address</code></td><td>The address that will lose minter role privileges</td></tr>
</tbody></table>
</div>
<h3 id="setpaused"><a class="header" href="#setpaused">setPaused</a></h3>
<p>Activates or deactivates the emergency pause mechanism</p>
<p><em>When paused, all token transfers, minting, and burning operations are halted to protect the protocol
during security incidents or system maintenance. Only emergency admins can trigger pause/unpause to ensure
rapid response capability. The pause state affects all token operations through the _beforeTokenTransfer hook.</em></p>
<pre><code class="language-solidity">function setPaused(bool isPaused_) external onlyRoles(EMERGENCY_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>isPaused_</code></td><td><code>bool</code></td><td>True to pause all operations, false to resume normal operations</td></tr>
</tbody></table>
</div>
<h3 id="emergencywithdraw"><a class="header" href="#emergencywithdraw">emergencyWithdraw</a></h3>
<p>Emergency recovery function for accidentally sent assets</p>
<p><em>This function provides a safety mechanism to recover tokens or ETH accidentally sent to the kToken
contract.
It's designed for emergency situations where users mistakenly transfer assets to the wrong address.
The function can handle both ERC20 tokens and native ETH. Only emergency admins can execute withdrawals
to prevent unauthorized asset extraction. This should not be used for regular operations.</em></p>
<pre><code class="language-solidity">function emergencyWithdraw(address token, address to, uint256 amount) external onlyRoles(EMERGENCY_ADMIN_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>address</code></td><td>The token contract address to withdraw (use address(0) for native ETH)</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>The destination address to receive the recovered assets</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The quantity of tokens or ETH to recover</td></tr>
</tbody></table>
</div>
<h3 id="_checkpaused"><a class="header" href="#_checkpaused">_checkPaused</a></h3>
<p>Internal function to validate that the contract is not in emergency pause state</p>
<p><em>Called before all token operations (transfers, mints, burns) to enforce emergency stops.
Reverts with KTOKEN_IS_PAUSED if the contract is paused, effectively halting all token activity.</em></p>
<pre><code class="language-solidity">function _checkPaused() private view;
</code></pre>
<h3 id="_beforetokentransfer"><a class="header" href="#_beforetokentransfer">_beforeTokenTransfer</a></h3>
<p>Internal hook that executes before any token transfer, mint, or burn operation</p>
<p><em>This critical function enforces the pause mechanism across all token operations by checking the pause
state before allowing any balance changes. It intercepts transfers, mints (from=0), and burns (to=0) to
ensure protocol-wide emergency stops work correctly. The hook pattern allows centralized control over
all token movements while maintaining ERC20 compatibility.</em></p>
<pre><code class="language-solidity">function _beforeTokenTransfer(address from, address to, uint256 amount) internal virtual override;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>from</code></td><td><code>address</code></td><td>The source address (address(0) for minting operations)</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>The destination address (address(0) for burning operations)</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The quantity of tokens being transferred/minted/burned</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="minted"><a class="header" href="#minted">Minted</a></h3>
<p>Emitted when tokens are minted</p>
<pre><code class="language-solidity">event Minted(address indexed to, uint256 amount);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>to</code></td><td><code>address</code></td><td>The address to which the tokens are minted</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The quantity of tokens minted</td></tr>
</tbody></table>
</div>
<h3 id="burned"><a class="header" href="#burned">Burned</a></h3>
<p>Emitted when tokens are burned</p>
<pre><code class="language-solidity">event Burned(address indexed from, uint256 amount);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>from</code></td><td><code>address</code></td><td>The address from which tokens are burned</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The quantity of tokens burned</td></tr>
</tbody></table>
</div>
<h3 id="tokencreated"><a class="header" href="#tokencreated">TokenCreated</a></h3>
<<<<<<< HEAD
<p>Emitted when a new token is created</p>
=======
>>>>>>> main
<pre><code class="language-solidity">event TokenCreated(address indexed token, address owner, string name, string symbol, uint8 decimals);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>address</code></td><td>The address of the new token</td></tr>
<tr><td><code>owner</code></td><td><code>address</code></td><td>The owner of the new token</td></tr>
<tr><td><code>name</code></td><td><code>string</code></td><td>The name of the new token</td></tr>
<tr><td><code>symbol</code></td><td><code>string</code></td><td>The symbol of the new token</td></tr>
<tr><td><code>decimals</code></td><td><code>uint8</code></td><td>The decimals of the new token</td></tr>
</tbody></table>
</div>
<h3 id="pausestate"><a class="header" href="#pausestate">PauseState</a></h3>
<p>Emitted when the pause state is changed</p>
<pre><code class="language-solidity">event PauseState(bool isPaused);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>isPaused</code></td><td><code>bool</code></td><td>The new pause state</td></tr>
</tbody></table>
</div>
<h3 id="authorizedcallerupdated"><a class="header" href="#authorizedcallerupdated">AuthorizedCallerUpdated</a></h3>
<p>Emitted when an authorized caller is updated</p>
<pre><code class="language-solidity">event AuthorizedCallerUpdated(address indexed caller, bool authorized);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>caller</code></td><td><code>address</code></td><td>The address of the caller</td></tr>
<tr><td><code>authorized</code></td><td><code>bool</code></td><td>Whether the caller is authorized</td></tr>
</tbody></table>
</div>
<h3 id="emergencywithdrawal"><a class="header" href="#emergencywithdrawal">EmergencyWithdrawal</a></h3>
<p>Emitted when an emergency withdrawal is requested</p>
<pre><code class="language-solidity">event EmergencyWithdrawal(address indexed token, address indexed to, uint256 amount, address indexed admin);
</code></pre>
<<<<<<< HEAD
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>address</code></td><td>The address of the token</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>The address to which the tokens will be sent</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The amount of tokens to withdraw</td></tr>
<tr><td><code>admin</code></td><td><code>address</code></td><td>The address of the admin</td></tr>
</tbody></table>
</div>
<h3 id="rescuedassets"><a class="header" href="#rescuedassets">RescuedAssets</a></h3>
<p>Emitted when assets are rescued</p>
<pre><code class="language-solidity">event RescuedAssets(address indexed asset, address indexed to, uint256 amount);
=======
<h3 id="rescuedassets"><a class="header" href="#rescuedassets">RescuedAssets</a></h3>
<pre><code class="language-solidity">event RescuedAssets(address indexed asset, address indexed to, uint256 amount);
</code></pre>
<h3 id="rescuedeth"><a class="header" href="#rescuedeth">RescuedETH</a></h3>
<pre><code class="language-solidity">event RescuedETH(address indexed asset, uint256 amount);
</code></pre>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="paused"><a class="header" href="#paused">Paused</a></h3>
<pre><code class="language-solidity">error Paused();
>>>>>>> main
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>asset</code></td><td><code>address</code></td><td>The address of the asset</td></tr>
<tr><td><code>to</code></td><td><code>address</code></td><td>The address to which the assets will be sent</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The amount of assets rescued</td></tr>
</tbody></table>
</div>
<h3 id="rescuedeth"><a class="header" href="#rescuedeth">RescuedETH</a></h3>
<p>Emitted when ETH is rescued</p>
<pre><code class="language-solidity">event RescuedETH(address indexed asset, uint256 amount);
</code></pre>
<<<<<<< HEAD
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>asset</code></td><td><code>address</code></td><td>The address of the asset</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The amount of ETH rescued</td></tr>
</tbody></table>
</div>
=======
<h3 id="zeroamount"><a class="header" href="#zeroamount">ZeroAmount</a></h3>
<pre><code class="language-solidity">error ZeroAmount();
</code></pre>
<h3 id="contractnotpaused"><a class="header" href="#contractnotpaused">ContractNotPaused</a></h3>
<pre><code class="language-solidity">error ContractNotPaused();
</code></pre>
<h3 id="transferfailed"><a class="header" href="#transferfailed">TransferFailed</a></h3>
<pre><code class="language-solidity">error TransferFailed();
</code></pre>

>>>>>>> main
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../src/kRegistry.sol/contract.kRegistry.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../src/kRegistry.sol/contract.kRegistry.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../solidity.min.js"></script>


    </div>
    </body>
</html>
